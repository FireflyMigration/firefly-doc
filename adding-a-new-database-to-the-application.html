<!DOCTYPE html>
<html lang="en" class="js flexbox flexboxlegacy canvas canvastext webgl no-touch geolocation postmessage websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers applicationcache svg inlinesvg smil svgclippaths">

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8" />
    <meta name="keywords" content="">

    <title>Adding a new database to the application</title>
    <link rel="shortcut icon" href="favicon.png" type="image/x-icon" />
    <link rel="stylesheet" href="assets/css/toc.css" />
    <link rel="stylesheet" href="assets/css/highlight.css" />
    <link rel="stylesheet" href="assets/css/prism.css" />
    <link rel="stylesheet" href="assets/css/prism-csdiff.css" />


    <link rel="stylesheet" href="assets/css/theme_firefly.css" />
    <link rel="stylesheet" href="assets/css/mermaid.css" />
</head>

<body class="markdown-body" role="document">
    <div class="wrapper" id="root">
        <div class="backdrop"></div>
        <div class="top-bar" role="navigation" aria-label="footer navigation">
            <div style="display:flex;">
                <div>
                    <a id="menu" class="btn btn-neutral">&#9776; </a>
                </div>
                <img src="assets/img/logo-big.png">
            </div>
            <div>
                <a id="previousButton" class="btn btn-neutral" style="visibility:hidden">Previous</a>
                <a id="nextButton" class="btn btn-neutral" style="visibility:hidden">Next</a>
            </div>
        </div>
        <div class="middle">

            <div class="container">

                <div class="content"><h1 id="adding-a-new-database-to-the-application">Adding a new database to the application</h1>
<p>There are several ways to add a database connection to the application. In this article, we will focus on a way based on the migrated code.
When adding a new database entry to our migrated application, we need to pay attention to two files:</p>
<ol>
<li>DataSources.cs</li>
<li>INI file (Configuration file)</li>
</ol>
<p>The <strong>DataSources</strong> class is located in the <strong>Base</strong> project under the Models folder and includes all the databases that are used by the application, similar to the databases list in Magic settings menu.</p>
<p>The <strong>INI file</strong> is imported from Magic and holds the database connection details of the application along with other configuration settings.</p>
<h2 id="datasources">DataSources</h2>
<p>In your <strong>DataSources</strong> class you should find at least one database entry and you can add more entries based on the samples in this article.
Below is an example of two connections entries to <strong>SQL databases</strong> (Northwind and pubs)</p>
<p><strong>SQL</strong></p>
<p><img src="adding_new_db_datasources.png" alt="" /></p>
<p>Each <strong>entry</strong> in this the DataSources class is a database that is used by one or more entities of the application. These entries are called “<strong>Properties</strong>” in C#, which in this case are similar to <strong>methods</strong> with a return value.</p>
<p>Let’s explore an SQL connection property:</p>
<p><strong>DynamicSQLSupportingDataProvider</strong></p>
<p>This is the return value which is a connection to an SQL database, rather than a Memory database, XML etc.</p>
<p><strong>get</strong></p>
<p>The get property (getter), which is the body of the method, asks the ConnectionManager class for a connection to an SQL database.</p>
<p><strong>ConnectionManager</strong></p>
<p>The ConnectionManager is responsible of opening and closing the connection with the database. It uses GetSQLDataProvider method to retrieve the database information from the INI</p>
<p><strong>GetSQLDataProvider</strong></p>
<p>This method pulls from the INI the connection details to the database by providing the name of the database entry in the INI file.</p>
<p>When the <strong>application loads</strong>, the ConnectionManager is populated with the connection details from the INI file.</p>
<p>Here are two more common database connections types</p>
<p><strong>Memory</strong></p>
<p><img src="memory_new_db.png" alt="" /></p>
<p><strong>XML</strong></p>
<p><img src="xml_new_db.png" alt="" /></p>
<h2 id="ini-file">INI File</h2>
<p>The configuration file (INI) is located in the <strong>root project</strong> (Marked in Bold in the Visual Studio solution).
The file is divided into sections surrounded by square brackets “[ ]” and we will focus on the database section <strong>[MAGIC_DATABASES]</strong></p>
<p><img src="MAGIC_DB_ini_file.png" alt="" /></p>
<p>As you can see, the Northwind and pubs databases are declared in this section and based on their entry names which are marked in yellow, the <strong>GetSQLDataProvider</strong> method we discussed earlier, is retrieving their database information.</p>
<h2 id="summary">Summary</h2>
<p>We saw above two files which we need in order to add a database connection to our application:</p>
<ol>
<li>DataSources.cs</li>
<li>INI file (Configuration file)</li>
</ol>
<p>These two files have one thing in common – <strong>The database entry name</strong>.
Once this is set correctly together with proper connection details in the INI file, the application will be able to issue a database connection.</p>



                    <hr />Help us improve,
                    <a href="https://github.com/FireflyMigration/firefly-doc/blob/master//30-Maintaining-the-Migrated-Application/75-Adding-a-new-database-to-the-application/index.md" target="_blank">Edit this page on GitHub</a>
                    <br /> or email us at
                    <a href="mailto:info@fireflymigration.com?Subject=Firefly%20Documentation%20Website" target="_top">info@fireflymigration.com</a>
                </div>

                <!-- .content -->




            </div>
            <!-- .container-->

            <aside class="left-sidebar">
                <div class="wy-side-nav-search-ff">
                    <a href="" class="test">
                        
                    </a>
                </div>
                <div id="menuTree" </div>
            </aside>
            <!-- .left-sidebar -->

            <aside class="right-sidebar"></aside>
            <!-- .right-sidebar -->

            </div>
            <!-- .middle-->



        </div>


        <script src="assets/js/mermaid.js"></script>
        <script src="assets/js/prism-start.js"></script>
        <script src="assets/js/prism-clike.js"></script>
        <script src="assets/js/prism-markup.js"></script>
        <script src="assets/js/prism-css.js"></script>
        <script src="assets/js/prism-javascript.js"></script>

        <script src="assets/js/prism-diff.js"></script>
        <script src="assets/js/prism-csdiff.js"></script>
        <script src="assets/js/prism-function.js"></script>

        <script src="assets/js/jquery-3.1.1.js"></script>


        <script>
            (function (i, s, o, g, r, a, m) {
                i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                    (i[r].q = i[r].q || []).push(arguments)
                }, i[r].l = 1 * new Date(); a = s.createElement(o),
                    m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
            })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

            ga('create', 'UA-4806432-3', 'auto');
            ga('send', 'pageview');

        </script>
        <script src="assets/js/tree.js"></script>
        <script language="javascript">
            buildTree('menuTree', 'adding-a-new-database-to-the-application.html', 'previousButton', 'nextButton');
        </script>
</body>

</html>