<!DOCTYPE html>
<html lang="en" class="js flexbox flexboxlegacy canvas canvastext webgl no-touch geolocation postmessage websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers applicationcache svg inlinesvg smil svgclippaths">

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta charset="utf-8" />
    <meta name="keywords" content="">

    <title>Additional Events for Data Related Debugging</title>
    <link rel="shortcut icon" href="favicon.png" type="image/x-icon" />
    <link rel="stylesheet" href="assets/css/toc.css" />
    <link rel="stylesheet" href="assets/css/highlight.css" />
    <link rel="stylesheet" href="assets/css/prism.css" />
    <link rel="stylesheet" href="assets/css/prism-csdiff.css" />


    <link rel="stylesheet" href="assets/css/theme_firefly.css" />
    <link rel="stylesheet" href="assets/css/mermaid.css" />
</head>

<body class="markdown-body" role="document">
    <div class="wrapper">

        <div class="middle">

            <div class="container">

                <div class="content" role="navigation" aria-label="footer navigation">
                    <a id="previousButton" class="btn btn-neutral float-left" style="visibility:hidden">Previous</a>
                    <a id="nextButton" class="btn btn-neutral float-right" style="visibility:hidden">Next</a>
                </div>
                <div class="content"><h1 id="additional-events-for-data-related-debugging">Additional Events for Data Related Debugging</h1>
<p>Sometimes you want to track down an update to a specific entity or a specific column. You can do that by overriding the <code>OnSavingRow</code> Entity method or by handle the <code>ValueChange</code> event of a column.</p>
<h2 id="overriding-the-onsavingrow-method-of-an-entity">overriding the <code>OnSavingRow</code> method of an entity</h2>
<p>As of version 30735 a new method was added to entity called <code>OnSavingRow</code>
The <code>OnSavingRow</code> event of entities is called after the <code>Controller</code>'s OnSavingRow and before the entity is saved to the database.
You can put all sorts of logic in such methods and you can also use it for debugging purposes. For example:</p>
<pre data-line="11,12,13,14,15,16,17,18" class="language-csdiff line-numbers"><code>public class Orders : Entity
{
    #region Columns
    ...
    #endregion
    public Orders() : base("dbo.Orders", "Orders", Northwind.Shared.DataSources.Northwind1)
    {
        Cached = false;
        InitializeIndexes();
    }
    protected override void OnSavingRow(IEntityOnSavingRowEventArgs e)
    {
        if (e.Activity == Activities.Update &amp;&amp; this.OrderDate.WasChanged)
        {
            System.Diagnostics.Debug.WriteLine("Order Date was Changed from:" + OrderDate.OriginalValue + " to: " + OrderDate.Value);
        }
        base.OnSavingRow(e);
    } </code></pre>
<h2 id="handling-the-valuechange-event-of-a-column">Handling the ValueChange event of a column</h2>
<p>Sometimes if you want to see what code exactly updates a column, simply handle it's <code>ValueChanged</code> event and add a breakpoint in it.
For example the following code will write to the output whenever the OrderDate is actually changed (way before it's saved to the database)</p>
<pre data-line="5,6,7,8" class="language-csdiff line-numbers"><code>public Orders() : base("dbo.Orders", "Orders", Northwind.Shared.DataSources.Northwind1)
{
    Cached = false;
    InitializeIndexes();
    OrderDate.ValueChanged += e =&gt;
    {
        System.Diagnostics.Debug.WriteLine("OrderDate was changed from " + e.PreviousValue + " to " + OrderDate.Value);
    };
} </code></pre>
<h2 id="finding-when-the-row-was-changed">Finding when the row was changed</h2>
<p>When the OnSavingRow() method is triggered, it means that the the row was changed.
In some cases, specially in large programs, you sometimes do not know where the change of the record came from.
The <code>RowChanging</code> event, which can be declared in the controller, can assist you with that.</p>
<pre data-line="6,7,8,9" class="language-csdiff line-numbers"><code>public ShowOrders()
 {
    Title = "ShowOrders";
    InitializeDataViewAndUserFlow();
    InitializeHandlers();
    RowChanging += () =&gt;
    {
       MessageBox.Show("Row was changed");
    };
} </code></pre>


                <br />
                        <a id="previousButton" class="btn btn-neutral float-left" style="visibility:hidden">Previous</a>

                        <a id="nextButton" class="btn btn-neutral" style="visibility:hidden;float:right">Next</a>
                    <hr />Help us improve,
                    <a href="https://github.com/FireflyMigration/firefly-doc/blob/master//30-Maintaining-the-Migrated-Application/27-Debugging-the-Migrated-Application/15-Debugging-Event-Hooks-and-BreakPoints/Additional-Events-for-Data-Related-Debugging.md" target="_blank">Edit this page on GitHub</a>
                    <br /> or email us at
                    <a href="mailto:info@fireflymigration.com?Subject=Firefly%20Documentation%20Website" target="_top">info@fireflymigration.com</a>
                </div>

                <!-- .content -->




            </div>
            <!-- .container-->

            <aside class="left-sidebar">
                <div class="wy-side-nav-search-ff">
                    <a href="" class="test">
                        <img src="assets/img/logo-big.png">
                    </a>
                </div>
                <div id="menuTree" </div>
            </aside>
            <!-- .left-sidebar -->

            <aside class="right-sidebar"></aside>
            <!-- .right-sidebar -->

            </div>
            <!-- .middle-->



        </div>


        <script src="assets/js/mermaid.js"></script>
        <script src="assets/js/prism-start.js"></script>
        <script src="assets/js/prism-clike.js"></script>
        <script src="assets/js/prism-markup.js"></script>
        <script src="assets/js/prism-css.js"></script>
        <script src="assets/js/prism-javascript.js"></script>

        <script src="assets/js/prism-diff.js"></script>
        <script src="assets/js/prism-csdiff.js"></script>
        <script src="assets/js/prism-function.js"></script>

        <script src="assets/js/jquery-3.1.1.js"></script>


        <script>
            (function (i, s, o, g, r, a, m) {
                i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                    (i[r].q = i[r].q || []).push(arguments)
                }, i[r].l = 1 * new Date(); a = s.createElement(o),
                    m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
            })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

            ga('create', 'UA-4806432-3', 'auto');
            ga('send', 'pageview');

        </script>
        <script src="assets/js/tree.js"></script>
        <script language="javascript">
            buildTree('menuTree', 'additional-events-for-data-related-debugging.html', 'previousButton', 'nextButton');
        </script>
</body>

</html>