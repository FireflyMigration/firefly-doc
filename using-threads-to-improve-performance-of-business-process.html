<!DOCTYPE html>
<html lang="en" class="js flexbox flexboxlegacy canvas canvastext webgl no-touch geolocation postmessage websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers applicationcache svg inlinesvg smil svgclippaths">

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8" />
    <meta name="keywords" content="parallel, paralel, async, run in new thread">

    <title>Using Threads to Improve Performance of Business Process</title>
    <link rel="shortcut icon" href="favicon.png" type="image/x-icon" />
    <link rel="stylesheet" href="assets/css/toc.css" />
    <link rel="stylesheet" href="assets/css/highlight.css" />
    <link rel="stylesheet" href="assets/css/prism.css" />
    <link rel="stylesheet" href="assets/css/prism-csdiff.css" />


    <link rel="stylesheet" href="assets/css/theme_firefly.css" />
    <link rel="stylesheet" href="assets/css/mermaid.css" />
</head>

<body class="markdown-body" role="document">
    <div class="wrapper" id="root">
        <div class="backdrop"></div>
        <div class="top-bar" role="navigation" aria-label="footer navigation">
            <div style="display:flex;">
                <div>
                    <a id="menu" class="btn btn-neutral">&#9776; </a>
                </div>
                <img src="assets/img/logo-big.png">
            </div>
            <div>
                <a id="previousButton" class="btn btn-neutral" style="visibility:hidden">Previous</a>
                <a id="nextButton" class="btn btn-neutral" style="visibility:hidden">Next</a>
            </div>
        </div>
        <div class="middle">

            <div class="container">

                <div class="content"><h1 id="using-threads-to-improve-performance-of-business-process">Using Threads to Improve Performance of Business Process</h1>
<p>In this article we show how to call a long business process to run on a new thread.</p>
<h2 id="replace-a-normal-call-to-a-call-in-a-new-thread">Replace a normal call to a call in a new Thread</h2>
<pre data-line="1,2,4" class="language-csdiff line-numbers"><code>ENV.Common.RunOnNewThread(() =&gt;
{
    new Demo.DemoLongProcess().Run();
},false); </code></pre>
<h2 id="important-things-to-know">Important things to know</h2>
<h3 id="context">Context</h3>
<p>Each thread has it's own Context, it's own connections to the database and it's own transactions.
Please review the <a href="http://doc.fireflymigration.com/context.html">Article about Context</a></p>
<h3 id="the-onstart-of-the-application-class">The OnStart of the Application Class</h3>
<p>The on start of the application class runs for every thread - sometimes you may have a lot of logic there, you'll need to condition that logic to only run in the first time and not always.</p>
<h3 id="use-connection-pools">Use Connection Pools</h3>
<p>By default, the migrated Windows Forms application doesn't use Connection pools, since it usually uses just one connection.
If you start using Threads extensively we recommend that you'll set the <code>ENV.Data.DataProvider.ConnectionManager.UseConnectionPool</code> to <code>true</code></p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/cXoog4IFA_k" frameborder="0" allowfullscreen></iframe>
<h2 id="monitoring-the-thread-progress">Monitoring the Thread progress</h2>
<p>The <code>RunOnNewThread</code> method return a <a href="https://docs.microsoft.com/en-us/dotnet/api/system.threading.thread">system.threading.thread</a> object that you can monitor.
You can use it's IsAlive property to monitor what's going on.
For example</p>
<pre data-line="" class="language-csdiff line-numbers"><code>var thread = ENV.Common.RunOnNewThread(() =&gt;
{
    new Demo.DemoLongProcess().Run();
},false);
while (thread.IsAlive)
{
    MessageBox.Show("Waiting to complete");
}
MessageBox.Show("Done"); </code></pre>
<h2 id="you-can-wait-for-multiple-threads-to-be-done-using-a-simple-list">You can wait for multiple Threads to be done using a simple List:</h2>
<pre data-line="" class="language-csdiff line-numbers"><code>var threads = new List&lt;Thread&gt;();
//run thread one
threads.Add( Common.RunOnNewThread(() =&gt;
{
    new Demo.DemoLongProcess().Run();
},false));
//run thread two
threads.Add(Common.RunOnNewThread(() =&gt;
{
    new Demo.DemoLongProcess().Run();
}, false));
//run thread three
threads.Add(Common.RunOnNewThread(() =&gt;
{
    new Demo.DemoLongProcess().Run();
}, false));


while (threads.Find(t=&gt;t.IsAlive)!=null)
{
    System.Windows.Forms.MessageBox.Show("Waiting to complete");
}
System.Windows.Forms.MessageBox.Show("Done"); </code></pre>



                    <hr />Help us improve,
                    <a href="https://github.com/FireflyMigration/firefly-doc/blob/master//30-Maintaining-the-Migrated-Application/Multi-Threading-and-Contexts/Using Threads to Improve Performance of Business Process.md" target="_blank">Edit this page on GitHub</a>
                    <br /> or email us at
                    <a href="mailto:info@fireflymigration.com?Subject=Firefly%20Documentation%20Website" target="_top">info@fireflymigration.com</a>
                </div>

                <!-- .content -->




            </div>
            <!-- .container-->

            <aside class="left-sidebar">
                <div class="wy-side-nav-search-ff">
                    <a href="" class="test">
                        
                    </a>
                </div>
                <div id="menuTree" </div>
            </aside>
            <!-- .left-sidebar -->

            <aside class="right-sidebar"></aside>
            <!-- .right-sidebar -->

            </div>
            <!-- .middle-->



        </div>


        <script src="assets/js/mermaid.js"></script>
        <script src="assets/js/prism-start.js"></script>
        <script src="assets/js/prism-clike.js"></script>
        <script src="assets/js/prism-markup.js"></script>
        <script src="assets/js/prism-css.js"></script>
        <script src="assets/js/prism-javascript.js"></script>

        <script src="assets/js/prism-diff.js"></script>
        <script src="assets/js/prism-csdiff.js"></script>
        <script src="assets/js/prism-function.js"></script>

        <script src="assets/js/jquery-3.1.1.js"></script>


        <script>
            (function (i, s, o, g, r, a, m) {
                i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                    (i[r].q = i[r].q || []).push(arguments)
                }, i[r].l = 1 * new Date(); a = s.createElement(o),
                    m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
            })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

            ga('create', 'UA-4806432-3', 'auto');
            ga('send', 'pageview');

        </script>
        <script src="assets/js/tree.js"></script>
        <script language="javascript">
            buildTree('menuTree', 'using-threads-to-improve-performance-of-business-process.html', 'previousButton', 'nextButton');
        </script>
</body>

</html>