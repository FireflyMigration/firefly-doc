<!DOCTYPE html>
<html lang="en" class="js flexbox flexboxlegacy canvas canvastext webgl no-touch geolocation postmessage websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers applicationcache svg inlinesvg smil svgclippaths">

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta charset="utf-8" />
    <meta name="keywords" content="columnscollection, columns.add">

    <title>Columns Add and the ColumnNotAddedToColumnCollection exception</title>
    <link rel="shortcut icon" href="favicon.png" type="image/x-icon" />
    <link rel="stylesheet" href="assets/css/toc.css" />
    <link rel="stylesheet" href="assets/css/highlight.css" />
    <link rel="stylesheet" href="assets/css/prism.css" />
    <link rel="stylesheet" href="assets/css/prism-csdiff.css" />


    <link rel="stylesheet" href="assets/css/theme_firefly.css" />
    <link rel="stylesheet" href="assets/css/mermaid.css" />
</head>

<body class="markdown-body" role="document">
    <div class="wrapper">

        <div class="middle">

            <div class="container">

                <div class="content" role="navigation" aria-label="footer navigation">
                    <a id="previousButton" class="btn btn-neutral float-left" style="visibility:hidden">Previous</a>
                    <a id="nextButton" class="btn btn-neutral float-right" style="visibility:hidden">Next</a>
                </div>
                <div class="content"><h1 id="columns-add-and-the-columnnotaddedtocolumncollection-exception">Columns Add and the ColumnNotAddedToColumnCollection exception</h1>
<p>Sometimes when you develop and use a column you may get the <strong>ColumnNotAddedToColumnCollection</strong> exception, with the following text:
'Column EmployeeID(EmployeeID) from Entity Orders(dbo.Orders) was not added to any controller's ColumnCollection. Did you forget Columns.Add?'</p>
<p>One way to solve this problem is to add the column to the <code>Columns</code> collection.</p>
<p>Another approach is to use the <code>AddAllColumns</code> method to automatically add all the columns and avoid the potential of this problem altogether.</p>
<p><strong>We recommend using the <code>AddAllColumns</code> in most controllers and avoid it only in special cases where it might have a negative effect.</strong></p>
<h2 id="why-do-we-need-the-columns-in-the-columns-collection-in-the-first-place">Why do we need the columns in the Columns Collection in the first place?</h2>
<p>The <code>Columns</code> collection is responsible for two things:</p>
<ol>
<li>Manage the recompute path of the <code>BindValue</code> method and the <code>Relations</code></li>
<li>For Columns that belongs to Entities, it gets their data from the database. For example for SQL databases, it'll add the column to the select statement.</li>
</ol>
<h2 id="why-doesnt-the-migrated-code-call-addallcolumns-automatically">Why doesn't the migrated code call AddAllColumns automatically?</h2>
<p>When you developed in magic, you specifically selected which columns are included, and only these columns were included in the select statement.</p>
<p>Initially we automatically used the Add all columns but we ran into the following problems:</p>
<ol>
<li>Some customers had entities that had columns that did not exist in the database and we would get an Invalid Column Name error.</li>
<li>Some customers used complex database-views, where adding a column had a significant effect on performance.</li>
<li>Some customers had huge tables with hundreds of fields, which caused a small negative effect on performance.</li>
</ol>
<p>Most of these considerations are not relevant to new code that you write or to 99% of the migrated code, but since in a migration project we need to match the behavior and performance of the original application, we needed to add the columns specifically.</p>
<p>**When writing new code - use the <code>AddAllColumns</code> - the performance cost is in 99% of cases insignificant. **</p>
<h2 id="when-not-to-use-addallcolumns">When not to use AddAllColumns?</h2>
<ol>
<li>If you have an <code>Entity</code> with columns that do not exist in the database.</li>
<li>If you have an <code>Entity</code> with Columns that are complex inner selects that add significant performance cost.</li>
<li>If you have an <code>Entity</code> with hundreds of columns, and you experience a performance problem - try removing the add all columns and add the columns manually and see if it has any effect on your code.</li>
</ol>
<h2 id="why-sometimes-when-i-forget-to-add-the-column-i-dont-get-this-error-and-sometimes-i-do">Why sometimes when I forget to add the Column I don't get this error and sometimes I do?</h2>
<p>You would only get the <strong>ColumnNotAddedToColumnCollection</strong> exception if you are trying to access the value of a Column that belongs to an Entity and that column was not added to the <code>Column</code> collection.</p>
<p>Columns will be automatically added to the columns collection in the following cases:</p>
<ol>
<li>If the column is part of the Primary Key of the Entity</li>
<li>If the column is used on the screen.</li>
<li>If the column is added through the <code>GetMandatoryColumns</code> method in the <code>Entity</code> - see the <a href="entity-onsavingrow.html">Entity OnSavingRow</a> article where we also explain this method.</li>
</ol>
<ul>
<li>Columns that are not connected to an Entity will also work without being added to the Columns collection - but they will not be part of the Recompute.</li>
</ul>


                <br />
                        <a id="previousButton" class="btn btn-neutral float-left" style="visibility:hidden">Previous</a>

                        <a id="nextButton" class="btn btn-neutral" style="visibility:hidden;float:right">Next</a>
                    <hr />Help us improve,
                    <a href="https://github.com/FireflyMigration/firefly-doc/blob/master//20-Getting-Familiar-with-Migrated-Code/50-DataAccess/Columns-Add-and-the-ColumnNotAddedToColumnCollection-exception.md" target="_blank">Edit this page on GitHub</a>
                    <br /> or email us at
                    <a href="mailto:info@fireflymigration.com?Subject=Firefly%20Documentation%20Website" target="_top">info@fireflymigration.com</a>
                </div>

                <!-- .content -->




            </div>
            <!-- .container-->

            <aside class="left-sidebar">
                <div class="wy-side-nav-search-ff">
                    <a href="" class="test">
                        <img src="assets/img/logo-big.png">
                    </a>
                </div>
                <div id="menuTree" </div>
            </aside>
            <!-- .left-sidebar -->

            <aside class="right-sidebar"></aside>
            <!-- .right-sidebar -->

            </div>
            <!-- .middle-->



        </div>


        <script src="assets/js/mermaid.js"></script>
        <script src="assets/js/prism-start.js"></script>
        <script src="assets/js/prism-clike.js"></script>
        <script src="assets/js/prism-markup.js"></script>
        <script src="assets/js/prism-css.js"></script>
        <script src="assets/js/prism-javascript.js"></script>

        <script src="assets/js/prism-diff.js"></script>
        <script src="assets/js/prism-csdiff.js"></script>
        <script src="assets/js/prism-function.js"></script>

        <script src="assets/js/jquery-3.1.1.js"></script>


        <script>
            (function (i, s, o, g, r, a, m) {
                i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                    (i[r].q = i[r].q || []).push(arguments)
                }, i[r].l = 1 * new Date(); a = s.createElement(o),
                    m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
            })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

            ga('create', 'UA-4806432-3', 'auto');
            ga('send', 'pageview');

        </script>
        <script src="assets/js/tree.js"></script>
        <script language="javascript">
            buildTree('menuTree', 'columns-add-and-the-columnnotaddedtocolumncollection-exception.html', 'previousButton', 'nextButton');
        </script>
</body>

</html>