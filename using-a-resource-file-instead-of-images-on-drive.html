<!DOCTYPE html>
<html lang="en" class="js flexbox flexboxlegacy canvas canvastext webgl no-touch geolocation postmessage websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers applicationcache svg inlinesvg smil svgclippaths">

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8" />
    <meta name="keywords" content="embedded images, embedded resources">

    <title>Using a resource file instead of images on drive</title>
    <link rel="shortcut icon" href="favicon.png" type="image/x-icon" />
    <link rel="stylesheet" href="assets/css/toc.css" />
    <link rel="stylesheet" href="assets/css/highlight.css" />
    <link rel="stylesheet" href="assets/css/prism.css" />
    <link rel="stylesheet" href="assets/css/prism-csdiff.css" />


    <link rel="stylesheet" href="assets/css/theme_firefly.css" />
    <link rel="stylesheet" href="assets/css/mermaid.css" />
</head>

<body class="markdown-body" role="document">
    <div class="wrapper" id="root">
        <div class="backdrop"></div>
        <div class="top-bar" role="navigation" aria-label="footer navigation">
            <div style="display:flex;">
                <div>
                    <a id="menu" class="btn btn-neutral">&#9776; </a>
                </div>
                <img src="assets/img/logo-big.png">
            </div>
            <div>
                <a id="previousButton" class="btn btn-neutral" style="visibility:hidden">Previous</a>
                <a id="nextButton" class="btn btn-neutral" style="visibility:hidden">Next</a>
            </div>
        </div>
        <div class="middle">

            <div class="container">

                <div class="content"><h1 id="using-a-resource-file-instead-of-images-on-drive">Using a resource file instead of images on drive</h1>
<p><code>ENV\Utilities\ImageLoader.cs</code></p>
<pre data-line="5,20,21,22,23,24,25,26,27,28" class="language-csdiff line-numbers"><code>namespace ENV.Utilities
{
    public class ImageLoader
    {
        public static System.Resources.ResourceManager ResourceManager;
        public static Image Load(string filePath, Size preferredSize)
        {
            if (filePath.StartsWith("@"))
            {
                filePath = filePath.Substring(1).TrimEnd();
                var i = filePath.LastIndexOf('.');
                if (i == -1) return null;
                var img = LoadNativeResource(filePath.Substring(0, i) + ".dll", filePath.Substring(i + 1));
                if (img is Icon) return ((Icon)img).ToBitmap();
                else return img as Image;
            }
            

            
            if (ResourceManager != null)
            {
                //System.Diagnostics.Trace.WriteLine(filePath);
                var key = System.IO.Path.GetFileNameWithoutExtension(filePath).Replace("-","_");
                //System.Diagnostics.Trace.WriteLine(key);
                object obj = ResourceManager.GetObject(key);
                if (obj != null)
                    return ((System.Drawing.Bitmap)(obj));
            }

            if (!System.IO.File.Exists(filePath)) return null;

            var extention = Path.GetExtension(filePath).ToUpper(CultureInfo.InvariantCulture);
            if (extention == ".PCX")
                return LoadPcx(filePath);
            if (extention == ".ICO")
                return new Icon(filePath, preferredSize).ToBitmap();

            return Image.FromStream(new MemoryStream(File.ReadAllBytes(filePath)));
        } </code></pre>
<p><code>program.cs</code></p>
<pre data-line="4" class="language-csdiff line-numbers"><code>{
    System.Windows.Forms.Application.EnableVisualStyles();
    System.Windows.Forms.Application.SetCompatibleTextRenderingDefault(false);
    ENV.Utilities.ImageLoader.ResourceManager = Northwind.Properties.Resources.ResourceManager;
    ENV.UserSettings.Version10Compatible = true;
    Text.StopProcessingFormatOnCharF = true;
    ENV.Data.DateColumn.GlobalDefault = new Date(1901,1,1);
    ENV.Commands.SetDefaultKeyboardMapping();
    ENV.Commands.SetVersion10CompatibleKeyMapping();
    ENV.Common.ApplicationTitle = "Northwind";
    ENV.UserSettings.FixedBackColorInNonFlatStyles = true;
    ENV.UserSettings.InitUserSettings("Northwind.ini", args);
} </code></pre>
<iframe width="560" height="315" src="https://www.youtube.com/embed/FUQsThCgZAk" frameborder="0" allowfullscreen></iframe>



                    <hr />Help us improve,
                    <a href="https://github.com/FireflyMigration/firefly-doc/blob/master//30-Maintaining-the-Migrated-Application/Using-a-resource-file-instead-of-images-on-drive/index.md" target="_blank">Edit this page on GitHub</a>
                    <br /> or email us at
                    <a href="mailto:info@fireflymigration.com?Subject=Firefly%20Documentation%20Website" target="_top">info@fireflymigration.com</a>
                </div>

                <!-- .content -->




            </div>
            <!-- .container-->

            <aside class="left-sidebar">
                <div class="wy-side-nav-search-ff">
                    <a href="" class="test">
                        
                    </a>
                </div>
                <div id="menuTree" </div>
            </aside>
            <!-- .left-sidebar -->

            <aside class="right-sidebar"></aside>
            <!-- .right-sidebar -->

            </div>
            <!-- .middle-->



        </div>


        <script src="assets/js/mermaid.js"></script>
        <script src="assets/js/prism-start.js"></script>
        <script src="assets/js/prism-clike.js"></script>
        <script src="assets/js/prism-markup.js"></script>
        <script src="assets/js/prism-css.js"></script>
        <script src="assets/js/prism-javascript.js"></script>

        <script src="assets/js/prism-diff.js"></script>
        <script src="assets/js/prism-csdiff.js"></script>
        <script src="assets/js/prism-function.js"></script>

        <script src="assets/js/jquery-3.1.1.js"></script>


        <script>
            (function (i, s, o, g, r, a, m) {
                i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                    (i[r].q = i[r].q || []).push(arguments)
                }, i[r].l = 1 * new Date(); a = s.createElement(o),
                    m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
            })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

            ga('create', 'UA-4806432-3', 'auto');
            ga('send', 'pageview');

        </script>
        <script src="assets/js/tree.js"></script>
        <script language="javascript">
            buildTree('menuTree', 'using-a-resource-file-instead-of-images-on-drive.html', 'previousButton', 'nextButton');
        </script>
</body>

</html>