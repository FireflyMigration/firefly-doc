<!DOCTYPE html>
<html lang="en" class="js flexbox flexboxlegacy canvas canvastext webgl no-touch geolocation postmessage websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers applicationcache svg inlinesvg smil svgclippaths">

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8" />
    <meta name="keywords" content="">

    <title>Adding ENV Web to an MVC project</title>
    <link rel="shortcut icon" href="favicon.png" type="image/x-icon" />
    <link rel="stylesheet" href="assets/css/toc.css" />
    <link rel="stylesheet" href="assets/css/highlight.css" />
    <link rel="stylesheet" href="assets/css/prism.css" />
    <link rel="stylesheet" href="assets/css/prism-csdiff.css" />


    <link rel="stylesheet" href="assets/css/theme_firefly.css" />
    <link rel="stylesheet" href="assets/css/mermaid.css" />
</head>

<body class="markdown-body" role="document">
    <div class="wrapper" id="root">
        <div class="backdrop"></div>
        <div class="top-bar" role="navigation" aria-label="footer navigation">
            <div style="display:flex;">
                <div>
                    <a id="menu" class="btn btn-neutral">&#9776; </a>
                </div>
                <img src="assets/img/logo-big.png">
            </div>
            <div>
                <a id="previousButton" class="btn btn-neutral" style="visibility:hidden">Previous</a>
                <a id="nextButton" class="btn btn-neutral" style="visibility:hidden">Next</a>
            </div>
        </div>
        <div class="middle">

            <div class="container">

                <div class="content"><h1 id="adding-env-web-to-an-mvc-project">Adding ENV Web to an MVC project</h1>
<p>This article explains how to add the ENV.Web functionality to an MVC project.</p>
<p>It assumes that you've followed the steps outlined in <a href="configuring-an-mvc-project-with-to-reuse-migrated-applications.html">Configuring an MVC Project with to reuse Migrated Applications</a></p>
<ol>
<li>Download the <code>ENV.Web.dll</code> from the <a href="https://github.com/FireflyMigration/ENV.Web/releases/tag/1.0.0.14">github repo</a></li>
<li>Place <code>ENV.Web.dll</code> in the lib folder.</li>
<li>Make sure that the dll is not blocked by windows, by opening the file properties and check the <code>unblock</code> checkbox.</li>
<li>Add a reference to it, in your MVC project.</li>
<li>Add a new controller and call it <code>DataApiController</code></li>
<li>Place the following code there:</li>
</ol>
<pre data-line="" class="language-csdiff line-numbers"><code>public class DataApiController : Controller
{
    static ENV.Web.DataApi _dataApi = new ENV.Web.DataApi();
    static DataApiController()
    {
    }
    // GET: DataApi
    public void Index(string name, string id = null)
    {
        _dataApi.ProcessRequest(name, id);
    }
} </code></pre>
<ol start="7">
<li>Edit the <code>RouteConfig</code> class to route to the added controller:</li>
</ol>
<pre data-line="4" class="language-csdiff line-numbers"><code>public static void RegisterRoutes(RouteCollection routes)
{
    routes.IgnoreRoute("{resource}.axd/{*pathInfo}");
     routes.MapRoute("DataApi", "dataApi/{name}/{id}", new { controller = "DataApi", action = "Index", name = UrlParameter.Optional, id = UrlParameter.Optional });
    routes.MapRoute(
        name: "Default",
        url: "{controller}/{action}/{id}",
        defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional }
    );
} </code></pre>
<ol start="8">
<li>Edit the 'Web.config' located at the root of your MVC project and added this lines:</li>
</ol>
<pre data-line="17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33" class="language-csdiff line-numbers"><code> &lt;?xml version="1.0" encoding="utf-8"?&gt;
 &lt;!--
  For more information on how to configure your ASP.NET application, please visit
  https://go.microsoft.com/fwlink/?LinkId=301880
  --&gt;
 &lt;configuration&gt;
  &lt;appSettings&gt;
    &lt;add key="webpages:Version" value="3.0.0.0"/&gt;
    &lt;add key="webpages:Enabled" value="false"/&gt;
    &lt;add key="ClientValidationEnabled" value="true"/&gt;
    &lt;add key="UnobtrusiveJavaScriptEnabled" value="true"/&gt;
  &lt;/appSettings&gt;
  &lt;system.web&gt;
    &lt;compilation debug="true" targetFramework="4.6.1"/&gt;
    &lt;httpRuntime targetFramework="4.6.1"/&gt;
  &lt;/system.web&gt;
  &lt;system.webServer&gt;
    &lt;handlers&gt;
      &lt;remove name="ExtensionlessUrlHandler-Integrated-4.0" /&gt;
      &lt;remove name="OPTIONSVerbHandler" /&gt;
      &lt;remove name="TRACEVerbHandler" /&gt;
      &lt;add name="ExtensionlessUrlHandler-Integrated-4.0" path="*." verb="*" type="System.Web.Handlers.TransferRequestHandler" +preCondition="integratedMode,runtimeVersionv4.0" /&gt;
      &lt;add name="Browser Link for HTML" path="*.html" verb="*"
         type="System.Web.StaticFileHandler, System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"
         resourceType="File" preCondition="integratedMode" /&gt;
      &lt;add name="ApiURIs-ISAPI-Integrated-4.0"
     path="/dataApi/*"
     verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS"
     type="System.Web.Handlers.TransferRequestHandler"
     preCondition="integratedMode,runtimeVersionv4.0" /&gt;
    &lt;/handlers&gt;
    &lt;validation validateIntegratedModeConfiguration="false" /&gt;  
  &lt;/system.webServer&gt;
  &lt;runtime&gt;
    &lt;assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1"&gt;
      &lt;dependentAssembly&gt;
        &lt;assemblyIdentity name="System.Web.Helpers" publicKeyToken="31bf3856ad364e35"/&gt;
        &lt;bindingRedirect oldVersion="1.0.0.0-3.0.0.0" newVersion="3.0.0.0"/&gt;
      &lt;/dependentAssembly&gt;
      &lt;dependentAssembly&gt;
        &lt;assemblyIdentity name="System.Web.WebPages" publicKeyToken="31bf3856ad364e35"/&gt;
        &lt;bindingRedirect oldVersion="1.0.0.0-3.0.0.0" newVersion="3.0.0.0"/&gt;
      &lt;/dependentAssembly&gt;
      &lt;dependentAssembly&gt;
        &lt;assemblyIdentity name="System.Web.Mvc" publicKeyToken="31bf3856ad364e35"/&gt;
        &lt;bindingRedirect oldVersion="1.0.0.0-5.2.4.0" newVersion="5.2.4.0"/&gt;
      &lt;/dependentAssembly&gt;
    &lt;/assemblyBinding&gt;
  &lt;/runtime&gt;
  &lt;system.codedom&gt;
   &lt;compilers&gt;
      &lt;compiler language="c#;cs;csharp" extension=".cs"
        type="Microsoft.CodeDom.Providers.DotNetCompilerPlatform.CSharpCodeProvider, Microsoft.CodeDom.Providers.DotNetCompilerPlatform, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"
        warningLevel="4" compilerOptions="/langversion:default /nowarn:1659;1699;1701"/&gt;
      &lt;compiler language="vb;vbs;visualbasic;vbscript" extension=".vb"
        type="Microsoft.CodeDom.Providers.DotNetCompilerPlatform.VBCodeProvider, Microsoft.CodeDom.Providers.DotNetCompilerPlatform, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"
        warningLevel="4" compilerOptions="/langversion:default /nowarn:41008 /define:_MYTYPE=\&amp;quot;Web\&amp;quot; /optionInfer+"/&gt;
    &lt;/compilers&gt;
  &lt;/system.codedom&gt;
 &lt;/configuration&gt; </code></pre>
<p>That's it, you are configured to use ENV.Web.
Review the following articles on how to use it:</p>
<ol>
<li><a href="creating-the-server-api.html">creating the server api</a></li>
<li><a href="making-the-rest-api-updatable.html">making the rest api updatable</a></li>
<li><a href="create-view-model.html">create view model</a></li>
<li><a href="automatically-generating-order-id-on-a-new-row.html">automatically generating order id on a new row.html</a></li>
<li><a href="server-side-validation-made-easy.html">server side validation made easy</a></li>
<li><a href="additional-server-side-features.html">additional server side features</a></li>
<li><a href="exposing-a-migrated-report-to-the-web.html">exposing a migrated report to the web</a></li>
</ol>



                    <hr />Help us improve,
                    <a href="https://github.com/FireflyMigration/firefly-doc/blob/master//30-Maintaining-the-Migrated-Application/95-Web-Development/20-ENV Web/01-Adding-ENV-Web-to-an-MVC-project.md" target="_blank">Edit this page on GitHub</a>
                    <br /> or email us at
                    <a href="mailto:info@fireflymigration.com?Subject=Firefly%20Documentation%20Website" target="_top">info@fireflymigration.com</a>
                </div>

                <!-- .content -->




            </div>
            <!-- .container-->

            <aside class="left-sidebar">
                <div class="wy-side-nav-search-ff">
                    <a href="" class="test">
                        
                    </a>
                </div>
                <div id="menuTree" </div>
            </aside>
            <!-- .left-sidebar -->

            <aside class="right-sidebar"></aside>
            <!-- .right-sidebar -->

            </div>
            <!-- .middle-->



        </div>


        <script src="assets/js/mermaid.js"></script>
        <script src="assets/js/prism-start.js"></script>
        <script src="assets/js/prism-clike.js"></script>
        <script src="assets/js/prism-markup.js"></script>
        <script src="assets/js/prism-css.js"></script>
        <script src="assets/js/prism-javascript.js"></script>

        <script src="assets/js/prism-diff.js"></script>
        <script src="assets/js/prism-csdiff.js"></script>
        <script src="assets/js/prism-function.js"></script>

        <script src="assets/js/jquery-3.1.1.js"></script>


        <script>
            (function (i, s, o, g, r, a, m) {
                i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                    (i[r].q = i[r].q || []).push(arguments)
                }, i[r].l = 1 * new Date(); a = s.createElement(o),
                    m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
            })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

            ga('create', 'UA-4806432-3', 'auto');
            ga('send', 'pageview');

        </script>
        <script src="assets/js/tree.js"></script>
        <script language="javascript">
            buildTree('menuTree', 'adding-env-web-to-an-mvc-project.html', 'previousButton', 'nextButton');
        </script>
</body>

</html>