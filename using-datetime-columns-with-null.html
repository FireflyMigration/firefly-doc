<!DOCTYPE html>
<html lang="en" class="js flexbox flexboxlegacy canvas canvastext webgl no-touch geolocation postmessage websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers applicationcache svg inlinesvg smil svgclippaths">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta charset="utf-8" />
    <meta name="keywords" content="">

    <title>Using DateTime columns with Null</title>
    <link rel="shortcut icon" href="favicon.png" type="image/x-icon" />
    <link rel="stylesheet" href="assets/css/toc.css" />
    <link rel="stylesheet" href="assets/css/highlight.css" />
    <link rel="stylesheet" href="assets/css/prism.css" />
    <link rel="stylesheet" href="assets/css/prism-csdiff.css" />


    <link rel="stylesheet" href="assets/css/theme_firefly.css" />
    <link rel="stylesheet" href="assets/css/mermaid.css" />
</head>
<body class="markdown-body" role="document">

    <div class="wrapper">

        <div class="middle">

            <div class="container">

                <div class="content" role="navigation" aria-label="footer navigation">
                    <a id="previousButton" class="btn btn-neutral float-left" style="visibility:hidden">Previous</a> <a id="nextButton" class="btn btn-neutral float-right" style="visibility:hidden">Next</a>
                </div>
                <div class="content"><h1 id="using-datetime-columns-with-null">Using DateTime columns with Null</h1>
<p>Using a DateTime column in an SQL table is quite common.
Using it in .Net has one limitation – DateTime cannot be null as it is a struct and not a class.</p>
<p><img src="DateTime_example.png" alt="" /></p>
<p>You can read more about it <a href="https://msdn.microsoft.com/en-us/library/1t3y8s4s.aspx">here</a></p>
<p>First, lets define a table with a DateTime column:</p>
<p><img src="CodeAndDate.png" alt="" /></p>
<p>In case you had a Time column coupled to a Date column in the original code, it will look like this in the migrated code:</p>
<p><img src="CodeAndDate1.png" alt="" /></p>
<p>There are better solutions than this.</p>
<p>Use an alternative value</p>
<p>This way you can determine what would be the value shown to the user / saved to the DB when a Null value is used.</p>
<p>This solution involves:</p>
<ul>
<li>Using the Firefly.Box.Date.DateTimeColumn – allowing you to have one column with both the date and time.</li>
<li>Determining what would be the Null value when reading from the DB columns / writing to the DB column.</li>
<li>Creating your own storage and using it in the column.</li>
</ul>
<p>The result would look like this:</p>
<p><img src="CodeAndDate2.png" alt="" /></p>
<p>Use a custom column</p>
<p>This way you can create your own column, based on your preferences.</p>
<p>This solution involves:</p>
<ul>
<li>Using a tweaked DateTime struct called “DateTime? ” which allows Null</li>
<li>Creating a new column and implementing all the methods and properties of the inheriting class.</li>
</ul>
<p>The result would look like this:</p>
<p><img src="CodeAndDate3.png" alt="" />
What to do when using a custom column</p>
<p>The Firefly entity generator recognizes the common column types and not a custom one. So when trying to generate the table such a column will be ignored.<br />
In order to correlate a custom column type with a common one, you need to:</p>
<ul>
<li>Inherit the interface ENV.Utilities.SqlScriptGenerator.IColumn</li>
<li>Implementing both DbType and DbDefault attributes</li>
<li>In its implementation set the DbType to a common one.</li>
</ul>
<p>The result would look like this:</p>
<p><img src="CodeAndDate4.png" alt="" /></p>
<p>Keep in mind that you can keep this new column type in the Shared project or even in the ENV project for reuse.</p>
<br /><hr />Help us improve, <a href="https://github.com/FireflyMigration/firefly-doc/blob/master//02-Development/03-Articles/DataAccess/22-Using-DateTime-columns-with-Null/index.md" target="_blank">Edit this page on GitHub</a></div><!-- .content -->
                
            </div><!-- .container-->
        
            <aside class="left-sidebar">
                <div class="wy-side-nav-search-ff">
                    <a href="" class="test">  <img src="assets/img/logo-big.png"></a>
                </div><div id="menuTree"</div>
            </aside><!-- .left-sidebar -->

            <aside class="right-sidebar"></aside><!-- .right-sidebar -->

        </div><!-- .middle-->



    </div>


    <script src="assets/js/mermaid.js"></script>
    <script src="assets/js/prism-start.js"></script>
    <script src="assets/js/prism-clike.js"></script>
    <script src="assets/js/prism-markup.js"></script>
    <script src="assets/js/prism-css.js"></script>
    <script src="assets/js/prism-javascript.js"></script>

    <script src="assets/js/prism-diff.js"></script>
    <script src="assets/js/prism-csdiff.js"></script>
    <script src="assets/js/prism-function.js"></script>

    <script src="assets/js/jquery-3.1.1.js"></script>
    
    
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-4806432-3', 'auto');
  ga('send', 'pageview');

    </script>
    <script src="assets/js/tree.js"></script>
    <script language="javascript">
        buildTree('menuTree', 'using-datetime-columns-with-null.html', 'previousButton', 'nextButton');
    </script>
</body>
</html>