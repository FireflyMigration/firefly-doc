<!DOCTYPE html>
<html lang="en" class="js flexbox flexboxlegacy canvas canvastext webgl no-touch geolocation postmessage websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers applicationcache svg inlinesvg smil svgclippaths">

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta charset="utf-8" />
    <meta name="keywords" content="">

    <title>Using GetValue Inner Select</title>
    <link rel="shortcut icon" href="favicon.png" type="image/x-icon" />
    <link rel="stylesheet" href="assets/css/toc.css" />
    <link rel="stylesheet" href="assets/css/highlight.css" />
    <link rel="stylesheet" href="assets/css/prism.css" />
    <link rel="stylesheet" href="assets/css/prism-csdiff.css" />


    <link rel="stylesheet" href="assets/css/theme_firefly.css" />
    <link rel="stylesheet" href="assets/css/mermaid.css" />
</head>

<body class="markdown-body" role="document">
    <div class="wrapper">

        <div class="middle">

            <div class="container">

                <div class="content" role="navigation" aria-label="footer navigation">
                    <a id="previousButton" class="btn btn-neutral float-left" style="visibility:hidden">Previous</a>
                    <a id="nextButton" class="btn btn-neutral float-right" style="visibility:hidden">Next</a>
                </div>
                <div class="content">
                    <h1 id="using-getvalue-inner-select">Using GetValue Inner Select</h1>
<p>Were going to use an Inner Select to get the value from the Exchange Rates table.</p>
<p>The first step is to add a local Column instead of the <code>Rate</code> column from the <code>ExchangeRate</code> entity.</p>
<p>Add the <code>Rate</code> Local Column</p>
<pre data-line="3" class="language-csdiff line-numbers"><code>#region Columns
readonly Types.Amount RowTotal = new Types.Amount { Caption = "RowTotal" };
readonly NumberColumn Rate = new NumberColumn("Rate", "2.4");
#endregion </code></pre>
<p>Add the <code>Rate</code> Local Column to the Column Collection, and add a BindValue for it.</p>
<pre data-line="3,4" class="language-csdiff line-numbers"><code>Columns.Add(ExchangeRates.Currency);
Columns.Add(ExchangeRates.EffectiveDate);
Columns.Add(ExchangeRates.Rate);
Rate.BindValue(ExchangeRates.Rate);
Columns.Add(Rate);
Columns.Add(CategorySales.Year);
Columns.Add(CategorySales.CategoryID); </code></pre>
<p>Use the local column in the expression</p>
<pre data-line="4" class="language-csdiff line-numbers"><code>protected override void OnLeaveRow()
{
-   RowTotal.Value = Order_Details.UnitPrice * Order_Details.Quantity * ExchangeRates.Rate;
    RowTotal.Value = Order_Details.UnitPrice * Order_Details.Quantity * this.Rate;
                
    if (u.Month(Orders.OrderDate) == 1)
        CategorySales.Jan.Value += RowTotal; </code></pre>
<iframe width="560" height="315" src="https://www.youtube.com/embed/IxWUUV_PZTI?list=PL1DEQjXG2xnJNtUHwUvmwYKay85F3WYMg" frameborder="0" allowfullscreen></iframe>
<ul>
<li><a href="using-the-original-relation-when-using-pervasive.html">Using the original relation when using Pervasive</a></li>
<li><a href="getvalue-inner-select.html">GetValue Inner Select</a></li>
<li><a href="understanding-the-sql-behind-the-scenes.html">Understanding the SQL behind the Scenes</a></li>
<li><a href="using-getvalue-for-multiple-columns.html">Using GetValue for multiple columns</a></li>
</ul>

                    <br/>
                    <script src="//www.powr.io/powr.js?external-type=html"></script>
                    <div class="powr-hit-counter" id="11a1240c_1540358974"></div>
                    <br />
                    <a id="previousButton" class="btn btn-neutral float-left" style="visibility:hidden">Previous</a>

                    <a id="nextButton" class="btn btn-neutral" style="visibility:hidden;float:right">Next</a>
                    <hr />Help us improve,
                    <a href="https://github.com/FireflyMigration/firefly-doc/blob/master//30-Maintaining-the-Migrated-Application/50-Improve-Performance/00-Reduce-calls-to-the-database/06-Using-GetValue-Inner-Select/01-index.md" target="_blank">Edit this page on GitHub</a>
                    <br /> or email us at
                    <a href="mailto:info@fireflymigration.com?Subject=Firefly%20Documentation%20Website" target="_top">info@fireflymigration.com</a>
                </div>

                <!-- .content -->




            </div>
            <!-- .container-->

            <aside class="left-sidebar">
                <div class="wy-side-nav-search-ff">
                    <a href="" class="test">
                        <img src="assets/img/logo-big.png">
                    </a>
                </div>
                <div id="menuTree" </div>
            </aside>
            <!-- .left-sidebar -->

            <aside class="right-sidebar"></aside>
            <!-- .right-sidebar -->

            </div>
            <!-- .middle-->



        </div>


        <script src="assets/js/mermaid.js"></script>
        <script src="assets/js/prism-start.js"></script>
        <script src="assets/js/prism-clike.js"></script>
        <script src="assets/js/prism-markup.js"></script>
        <script src="assets/js/prism-css.js"></script>
        <script src="assets/js/prism-javascript.js"></script>

        <script src="assets/js/prism-diff.js"></script>
        <script src="assets/js/prism-csdiff.js"></script>
        <script src="assets/js/prism-function.js"></script>

        <script src="assets/js/jquery-3.1.1.js"></script>


        <script>
            (function (i, s, o, g, r, a, m) {
                i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                    (i[r].q = i[r].q || []).push(arguments)
                }, i[r].l = 1 * new Date(); a = s.createElement(o),
                    m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
            })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

            ga('create', 'UA-4806432-3', 'auto');
            ga('send', 'pageview');

        </script>
        <script src="assets/js/tree.js"></script>
        <script language="javascript">
            buildTree('menuTree', 'using-getvalue-inner-select.html', 'previousButton', 'nextButton');
        </script>
</body>

</html>