<!DOCTYPE html>
<html lang="en" class="js flexbox flexboxlegacy canvas canvastext webgl no-touch geolocation postmessage websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers applicationcache svg inlinesvg smil svgclippaths">

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8" />
    <meta name="keywords" content="">

    <title>Copying a Controller with inner Controllers and Views</title>
    <link rel="shortcut icon" href="favicon.png" type="image/x-icon" />
    <link rel="stylesheet" href="assets/css/toc.css" />
    <link rel="stylesheet" href="assets/css/highlight.css" />
    <link rel="stylesheet" href="assets/css/prism.css" />
    <link rel="stylesheet" href="assets/css/prism-csdiff.css" />


    <link rel="stylesheet" href="assets/css/theme_firefly.css" />
    <link rel="stylesheet" href="assets/css/mermaid.css" />
</head>

<body class="markdown-body" role="document">
    <div class="wrapper" id="root">
        <div class="backdrop"></div>
        <div class="top-bar" role="navigation" aria-label="footer navigation">
            <div style="display:flex;">
                <div>
                    <a id="menu" class="btn btn-neutral">&#9776; </a>
                </div>
                <img src="assets/img/logo-big.png">
            </div>
            <div>
                <a id="previousButton" class="btn btn-neutral" style="visibility:hidden">Previous</a>
                <a id="nextButton" class="btn btn-neutral" style="visibility:hidden">Next</a>
            </div>
        </div>
        <div class="middle">

            <div class="container">

                <div class="content"><h1 id="copying-a-controller-with-inner-controllers-and-views">Copying a Controller with inner Controllers and Views</h1>
<p>Here are the steps to follow when duplicating a controller.</p>
<p>Duplicating a controller with a view involves the following steps:</p>
<ol>
<li><strong>Duplicate the class</strong></li>
<li><strong>Rename the new class and it's constructor</strong></li>
<li><strong>Fix the references in the inner Controllers (child controllers)</strong></li>
<li><strong>If it has a View</strong><br />
4.1. <strong>Duplicate the View class</strong><br />
4.2. <strong>Rename the new View class, it's constructor and it's designer class</strong><br />
4.3. <strong>Fix the references between the View and the Controller</strong></li>
<li><strong>For any of the inner Controllers views</strong><br />
5.1 <strong>Duplicate the inner Controller's View</strong><br />
5.2. <strong>Rename the new View class, it's constructor and it's designer class</strong><br />
5.3. <strong>Fix the references between the View and the Controller</strong></li>
</ol>
<iframe width="560" height="315" src="https://www.youtube.com/embed/D3JMAzqfrpk" frameborder="0" allowfullscreen></iframe>
<h2 id="steps-breakdown">Steps Breakdown</h2>
<h3 id="step-1-duplicate-the-class">Step 1 - Duplicate the class</h3>
<h3 id="step-2-rename-the-new-class">Step 2 - Rename the new class</h3>
<p>Change the class name, in our case from <code>ShowOrders</code> to <code>ShowOrdersCopy</code></p>
<ul>
<li>Don't forgen to rename the constructor.</li>
</ul>
<pre data-line="2,5" class="language-csdiff line-numbers"><code>- public class ShowOrders : Northwind.FlowUIControllerBase,IShowOrders 
  public class ShowOrdersCopy : Northwind.FlowUIControllerBase,IShowOrders 
 {
-    public ShowOrders()
     public ShowOrdersCopy()
    {
        Title = "Show Orders";
        InitializeDataViewAndUserFlow();
        InitializeHandlers();
    } </code></pre>
<h3 id="step-3-fix-the-references-in-the-inner-controllers-child-controllers">Step 3 - Fix the references in the inner Controllers (child controllers)</h3>
<p><strong>Details inner Controller</strong></p>
<pre data-line="6,8" class="language-csdiff line-numbers"><code>/// &lt;summary&gt;Details(P#5.1)&lt;/summary&gt;
/// &lt;remark&gt;Last change before Migration: 02/01/2008 09:11:36&lt;/remark&gt;
internal class Details : Northwind.UIControllerBase 
{
-   ShowOrders _parent;
    ShowOrdersCopy _parent;
-   public Details(ShowOrders parent)
    public Details(ShowOrdersCopy parent)
    {
        _parent = parent;
        Title = "Details";
        InitializeDataView();
        InitializeHandlers();
    } </code></pre>
<p><strong>Totals inner Controller</strong></p>
<pre data-line="6,8" class="language-csdiff line-numbers"><code>/// &lt;summary&gt;Totals(P#5.2)&lt;/summary&gt;
/// &lt;remark&gt;Last change before Migration: 11/04/2007 20:09:10&lt;/remark&gt;
class Totals : Northwind.BusinessProcessBase 
{
-   ShowOrders _parent;
    ShowOrdersCopy _parent;
-   public Totals(ShowOrders parent)
    public Totals(ShowOrdersCopy parent)
    {
        _parent = parent;
        Title = "Totals";
        InitializeDataView();
    } </code></pre>
<h3 id="step-4-if-it-has-a-view">Step 4 - If it has a view</h3>
<h4 id="step-4.1-duplicate-the-view-class">Step 4.1 - Duplicate the View class</h4>
<h4 id="step-4.2-rename-the-new-view-class">Step 4.2 - Rename the new View class</h4>
<h5 id="rename-the-view-class-and-its-constructor">4.2.1 -  Rename the View class and it's constructor</h5>
<pre data-line="2,6" class="language-csdiff line-numbers"><code>- partial class ShowOrdersView : Northwind.Shared.Theme.Controls.CompatibleForm 
  partial class ShowOrdersCopyView : Northwind.Shared.Theme.Controls.CompatibleForm 
 {
    ShowOrders _controller;
-   internal ShowOrdersView(ShowOrders controller)
    internal ShowOrdersCopyView(ShowOrders controller)
    {
        _controller = controller;
        InitializeComponent();
    } </code></pre>
<h5 id="rename-the-designer-class">4.2.2 - Rename the designer class</h5>
<p><img src="2018-04-20_08h23_23.png" alt="2018 04 20 08H23 23" /></p>
<pre data-line="2" class="language-csdiff line-numbers"><code>- partial class ShowOrdersView
  partial class ShowOrdersCopyView
 {
    System.ComponentModel.IContainer components;
    Shared.Theme.Colors.DefaultHelpWindow clrDefaultHelpWindow; </code></pre>
<h4 id="step-4.3-fix-the-references-between-the-view-and-the-controller">Step 4.3 - Fix the References between the View and the Controller</h4>
<h5 id="fix-the-reference-from-the-view-to-the-controller">4.3.1 - Fix the reference from the View to the Controller</h5>
<pre data-line="4,6" class="language-csdiff line-numbers"><code>partial class ShowOrdersCopyView : Northwind.Shared.Theme.Controls.CompatibleForm 
{
-   ShowOrders _controller;
    ShowOrdersCopy _controller;
-   internal ShowOrdersCopyView(ShowOrders controller)
    internal ShowOrdersCopyView(ShowOrdersCopy controller)
    {
        _controller = controller;
        InitializeComponent();
    } </code></pre>
<h5 id="fix-the-reference-from-the-controller-to-the-view">4.3.2 Fix the reference from the Controller to the View</h5>
<pre data-line="6" class="language-csdiff line-numbers"><code>protected override void OnLoad()
{
    RowLocking = LockingStrategy.OnRowSaving;
    TransactionScope = TransactionScopes.SaveToDatabase;
-   View = () =&gt; new Views.ShowOrdersView(this);
    View = () =&gt; new Views.ShowOrdersCopyView(this);
} </code></pre>
<h3 id="step-5-for-any-of-the-inner-controllers-views">Step 5 - For any of the inner Controllers views</h3>
<h4 id="step-5.1-duplicate-the-inner-controllers-view">Step 5.1 - Duplicate the inner Controller's View</h4>
<h4 id="step-5.2-rename-the-new-view-class">Step 5.2 - Rename the new View class</h4>
<h5 id="rename-the-view-class-and-its-constructor-1">5.2.1 -  Rename the View class and it's constructor</h5>
<pre data-line="2,6" class="language-csdiff line-numbers"><code>- partial class ShowOrdersDetails : Northwind.Shared.Theme.Controls.CompatibleForm 
  partial class ShowOrdersCopyDetails : Northwind.Shared.Theme.Controls.CompatibleForm 
 {
    ShowOrders.Details _controller;
-   internal ShowOrdersDetails(ShowOrders.Details controller)
    internal ShowOrdersCopyDetails(ShowOrders.Details controller)
    {
        _controller = controller;
        InitializeComponent();
    } </code></pre>
<h5 id="rename-the-designer-class-1">5.2.2 - Rename the designer class</h5>
<pre data-line="2" class="language-csdiff line-numbers"><code>- partial class ShowOrdersDetails
  partial class ShowOrdersCopyDetails
 {
    System.ComponentModel.IContainer components;
    Shared.Theme.Colors.DefaultHelpWindow clrDefaultHelpWindow; </code></pre>
<h4 id="step-5.3-fix-the-references-between-the-view-and-the-controller">Step 5.3 - Fix the References between the View and the Controller</h4>
<h5 id="fix-the-reference-from-the-view-to-the-controller-1">5.3.1 - Fix the reference from the View to the Controller</h5>
<pre data-line="4,6" class="language-csdiff line-numbers"><code>partial class ShowOrdersCopyDetails : Northwind.Shared.Theme.Controls.CompatibleForm 
{
-   ShowOrders.Details _controller;
    ShowOrdersCopy.Details _controller;
-   internal ShowOrdersCopyDetails(ShowOrders.Details controller)
    internal ShowOrdersCopyDetails(ShowOrdersCopy.Details controller)
    {
        _controller = controller;
        InitializeComponent();
    } </code></pre>
<h5 id="fix-the-reference-from-the-controller-to-the-view-1">5.3.2 Fix the reference from the Controller to the View</h5>
<pre data-line="8" class="language-csdiff line-numbers"><code>protected override void OnLoad()
{
    Exit(ExitTiming.BeforeRow, () =&gt; u.Level(1) != "RM");
    RowLocking = LockingStrategy.OnUserEdit;
    SwitchToInsertWhenNoRows = true;
    KeepViewVisibleAfterExit = true;
-   View = () =&gt; new Views.ShowOrdersDetails(this);
    View = () =&gt; new Views.ShowOrdersCopyDetails(this);
} </code></pre>



                    <hr />Help us improve,
                    <a href="https://github.com/FireflyMigration/firefly-doc/blob/master//30-Maintaining-the-Migrated-Application/Copying Controllers (programs)/04-Copying-a-Controller-with-inner-Controllers-and-Views.md" target="_blank">Edit this page on GitHub</a>
                    <br /> or email us at
                    <a href="mailto:info@fireflymigration.com?Subject=Firefly%20Documentation%20Website" target="_top">info@fireflymigration.com</a>
                </div>

                <!-- .content -->




            </div>
            <!-- .container-->

            <aside class="left-sidebar">
                <div class="wy-side-nav-search-ff">
                    <a href="" class="test">
                        
                    </a>
                </div>
                <div id="menuTree" </div>
            </aside>
            <!-- .left-sidebar -->

            <aside class="right-sidebar"></aside>
            <!-- .right-sidebar -->

            </div>
            <!-- .middle-->



        </div>


        <script src="assets/js/mermaid.js"></script>
        <script src="assets/js/prism-start.js"></script>
        <script src="assets/js/prism-clike.js"></script>
        <script src="assets/js/prism-markup.js"></script>
        <script src="assets/js/prism-css.js"></script>
        <script src="assets/js/prism-javascript.js"></script>

        <script src="assets/js/prism-diff.js"></script>
        <script src="assets/js/prism-csdiff.js"></script>
        <script src="assets/js/prism-function.js"></script>

        <script src="assets/js/jquery-3.1.1.js"></script>


        <script>
            (function (i, s, o, g, r, a, m) {
                i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                    (i[r].q = i[r].q || []).push(arguments)
                }, i[r].l = 1 * new Date(); a = s.createElement(o),
                    m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
            })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

            ga('create', 'UA-4806432-3', 'auto');
            ga('send', 'pageview');

        </script>
        <script src="assets/js/tree.js"></script>
        <script language="javascript">
            buildTree('menuTree', 'copying-a-controller-with-inner-controllers-and-views.html', 'previousButton', 'nextButton');
        </script>
</body>

</html>