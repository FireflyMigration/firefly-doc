<!DOCTYPE html>
<html lang="en" class="js flexbox flexboxlegacy canvas canvastext webgl no-touch geolocation postmessage websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers applicationcache svg inlinesvg smil svgclippaths">

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta charset="utf-8" />
    <meta name="keywords" content="">

    <title>Using WPF Menu</title>
    <link rel="shortcut icon" href="favicon.png" type="image/x-icon" />
    <link rel="stylesheet" href="assets/css/toc.css" />
    <link rel="stylesheet" href="assets/css/highlight.css" />
    <link rel="stylesheet" href="assets/css/prism.css" />
    <link rel="stylesheet" href="assets/css/prism-csdiff.css" />


    <link rel="stylesheet" href="assets/css/theme_firefly.css" />
    <link rel="stylesheet" href="assets/css/mermaid.css" />
</head>

<body class="markdown-body" role="document">
    <div class="wrapper">

        <div class="middle">

            <div class="container">

                <div class="content" role="navigation" aria-label="footer navigation">
                    <a id="previousButton" class="btn btn-neutral float-left" style="visibility:hidden">Previous</a>
                    <a id="nextButton" class="btn btn-neutral float-right" style="visibility:hidden">Next</a>
                </div>
                <div class="content"><h1 id="using-wpf-menu">Using WPF Menu</h1>
<p>In this article we'll explain how you can add the WPF menu to an existing application.</p>
<p>First, please download the latest version of <code>Firefly.Wpf.MenuDemo.exe</code> from <a href="https://github.com/FireflyMigration/WpfMenuDemo/releases">Github</a> and add a reference to it in your project.</p>
<p>First let's start by calling the <code>WPF</code> menu to make sure that it works:</p>
<pre data-line="" class="language-csdiff line-numbers"><code>Firefly.Wpf.MenuDemo.WpfMenu.Run(
    addRootMenu =&gt;
    {
    },
    title: "the title",
    image: @"c:\temp\backgroundImage.jpg",
    logoImage: @"c:\temp\logo-big.jpg"
    ); </code></pre>
<p>It recieves several parameters:</p>
<ol>
<li><code>addItems</code> - used to add items to the menu, we'll discuss it in depth soon.</li>
<li><code>title</code> - the text title that'll be displayed in the menu</li>
<li><code>image</code> - the background image that will be displayed in the menu</li>
<li><code>logoImage</code> - a smaller image that'll be displayed at the to of the menu.</li>
</ol>
<p><img src="2019-08-21_12h20_08.png" alt="" /></p>
<h3 id="using-logical-names-for-the-images">Using Logical Names for the Images</h3>
<p>To translate logical names, user the <code>PathDecoder.Decode</code> method.</p>
<pre data-line="8,9" class="language-csdiff line-numbers"><code>Firefly.Wpf.MenuDemo.WpfMenu.Run(
    addRootMenu =&gt;
    {
    },
    title: "the title",
-    image: @"c:\temp\backgroundImage.jpg",
-    logoImage: @"c:\temp\logo-big.jpg"
     image: PathDecoder.DecodePath(@"%Images%backgroundImage.jpg"),
     logoImage: PathDecoder.DecodePath(@"%Images%logo-big.png")
    ); </code></pre>
<h3 id="loading-items-into-the-menu-root">Loading items into the menu root</h3>
<p>The WPF menu can hold 3 generations of menus (if you want more, download the source code from <a href="https://github.com/FireflyMigration/WpfMenuDemo/tree/material-design">github</a> and change it)</p>
<p>Adding root menus is done by calling the <code>addRootMenu</code> method that was recieved in the first parameter.</p>
<pre data-line="4,5,6,7,8" class="language-csdiff line-numbers"><code>Firefly.Wpf.MenuDemo.WpfMenu.Run(
    addRootMenu =&gt;
    {
         addRootMenu("Show Orders",
             () =&gt; new ShowOrders().Run(),
             addSecondLevelMenu =&gt;
             {
             });
    },
    title: "the title",
    image: PathDecoder.DecodePath(@"%Images%backgroundImage.jpg"),
    logoImage: PathDecoder.DecodePath(@"%Images%logo-big.png")
    ); </code></pre>
<p>This method recieves 3 parameters:</p>
<ol>
<li>Menu's text</li>
<li>An Action to be called when the menu is clicked - send null if the menu is not clickable.</li>
<li>addItems - a method that is used to add child menus to this specific root menu.</li>
</ol>
<h3 id="loading-second-level-items">Loading second level items</h3>
<p>Simpy call the <code>addSecindLevelMenu</code> from within the scope (curley brackets) of the first menu</p>
<pre data-line="8,9,10,11,12" class="language-csdiff line-numbers"><code>Firefly.Wpf.MenuDemo.WpfMenu.Run(
    addRootMenu =&gt;
    {
        addRootMenu("Show Orders",
            () =&gt; new ShowOrders().Run(),
            addSecondLevelMenu =&gt;
            {
                addSecondLevelMenu("second level child menu", null,
                    addThirdLevelMenu =&gt;
                    {

                    });
            });
    },
    title: "the title",
    image: PathDecoder.DecodePath(@"%Images%backgroundImage.jpg"),
    logoImage: PathDecoder.DecodePath(@"%Images%logo-big.png")
    ); </code></pre>
<p>The <code>addSecondLevelMenu</code> method recieves the same parameters as the <code>addRootMenu</code></p>
<h3 id="loading-third-level-items">Loading third level items</h3>
<p>I'm guessing you get the picture by now, it's pretty similar, only in a third level item, you only send two parameters as we only support 3 hirarchies at this time.</p>
<pre data-line="11" class="language-csdiff line-numbers"><code>Firefly.Wpf.MenuDemo.WpfMenu.Run(
    addRootMenu =&gt;
    {
        addRootMenu("Show Orders",
            () =&gt; new ShowOrders().Run(),
            addSecondLevelMenu =&gt;
            {
                addSecondLevelMenu("second level child menu", null,
                    addThirdLevelMenu =&gt;
                    {
                        addThirdLevelMenu("My Third level menu", ()=&gt;MessageBox.Show("Click"));
                    });
            });
    },
    title: "the title",
    image: PathDecoder.DecodePath(@"%Images%backgroundImage.jpg"),
    logoImage: PathDecoder.DecodePath(@"%Images%logo-big.png")
    ); </code></pre>
<h3 id="loading-menues-from-a-the-database">Loading menues from a the database</h3>
<p>To demo this, I'll create a menu that has customers in the first level, and Orders in the second level, so when you click on an Order it get's printed.
Not realistic but it explains the point :)</p>
<p>Let's start with the previous code sample. Instead of adding the root menu hard coded - we'll use the customers table for this.</p>
<pre data-line="9,10,11,12,13,21" class="language-csdiff line-numbers"><code>Firefly.Wpf.MenuDemo.WpfMenu.Run(
    addRootMenu =&gt;
    {
        addRootMenu("Show Orders",
            () =&gt; new ShowOrders().Run(),
            addSecondLevelMenu =&gt;
            {
            });
        var c = new Models.Customers();
        c.ForEachRow(() =&gt;
        {
            addRootMenu(c.CompanyName.Value.Trim(),
                null,
                addSecondLevelMenu =&gt;
                {
                    addSecondLevelMenu("second level child menu", null,
                        addThirdLevelMenu =&gt;
                        {
                        });
                });
        });
    },
    title: "the title",
    image: PathDecoder.DecodePath(@"%Images%backgroundImage.jpg"),
    logoImage: PathDecoder.DecodePath(@"%Images%logo-big.png")
    ); </code></pre>
<p>Next let's get the orders of each customer and place it in a sub menu:</p>
<pre data-line="17,18,19,20,21,25" class="language-csdiff line-numbers"><code>Firefly.Wpf.MenuDemo.WpfMenu.Run(
    addRootMenu =&gt;
    {
        addRootMenu("Show Orders",
            () =&gt; new ShowOrders().Run(),
            addSecondLevelMenu =&gt;
            { 
            });
        var c = new Models.Customers();
        c.ForEachRow(() =&gt;
        {
            addRootMenu(c.CompanyName.Value.Trim(),
                null,
                addSecondLevelMenu =&gt;
                {
-                   addSecondLevelMenu("second level child menu", null,
                    var o = new Models.Orders();
                    o.ForEachRow(o.CustomerID.IsEqualTo(c.CustomerID), () =&gt;
                    {
                        addSecondLevelMenu("Order: " + o.OrderID.ToString().Trim(),
                            null,
                            addThirdLevelMenu =&gt;
                            {
                            });
                    });
                });
        });
    },
    title: "the title",
    image: PathDecoder.DecodePath(@"%Images%backgroundImage.jpg"),
    logoImage: PathDecoder.DecodePath(@"%Images%logo-big.png")
    ); </code></pre>
<h3 id="calling-a-controller-from-the-menu">Calling a Controller from the Menu</h3>
<pre data-line="19,22" class="language-csdiff line-numbers"><code> Firefly.Wpf.MenuDemo.WpfMenu.Run(
    addRootMenu =&gt;
    {
        addRootMenu("Show Orders",
            () =&gt; new ShowOrders().Run(),
        addSecondLevelMenu =&gt;
        {
        });
            var c = new Models.Customers();
            c.ForEachRow(() =&gt;
            {
                addRootMenu(c.CompanyName.Value.Trim(),
                    null,
                    addSecondLevelMenu =&gt;
                    {
                        var o = new Models.Orders();
                        o.ForEachRow(o.CustomerID.IsEqualTo(c.CustomerID), () =&gt;
                        {
                            var orderId = o.OrderID.Value;// We need to remember the specific order id to later use it when we call the controller
                            addSecondLevelMenu("Order: " + o.OrderID.ToString().Trim(),
-                               null,
                                () =&gt; new Print_Order().Run(orderId),
                                addThirdLevelMenu =&gt;
                                {
                                });
                        });
                    });
            });
        },
    title: "the title",
    image: PathDecoder.DecodePath(@"%Images%backgroundImage.jpg"),
    logoImage: PathDecoder.DecodePath(@"%Images%logo-big.png")
    ); </code></pre>
<ul>
<li>note that in line 14 we are storing the <code>OrderId</code> of the specific order that we later want to print. If we do not do that - whenever we'll print it'll print the last order id.</li>
</ul>


                <br />
                        <a id="previousButton" class="btn btn-neutral float-left" style="visibility:hidden">Previous</a>

                        <a id="nextButton" class="btn btn-neutral" style="visibility:hidden;float:right">Next</a>
                    <hr />Help us improve,
                    <a href="https://github.com/FireflyMigration/firefly-doc/blob/master//30-Maintaining-the-Migrated-Application/70-User Interface/Using-WPF-Menu/index.md" target="_blank">Edit this page on GitHub</a>
                    <br /> or email us at
                    <a href="mailto:info@fireflymigration.com?Subject=Firefly%20Documentation%20Website" target="_top">info@fireflymigration.com</a>
                </div>

                <!-- .content -->




            </div>
            <!-- .container-->

            <aside class="left-sidebar">
                <div class="wy-side-nav-search-ff">
                    <a href="" class="test">
                        <img src="assets/img/logo-big.png">
                    </a>
                </div>
                <div id="menuTree" </div>
            </aside>
            <!-- .left-sidebar -->

            <aside class="right-sidebar"></aside>
            <!-- .right-sidebar -->

            </div>
            <!-- .middle-->



        </div>


        <script src="assets/js/mermaid.js"></script>
        <script src="assets/js/prism-start.js"></script>
        <script src="assets/js/prism-clike.js"></script>
        <script src="assets/js/prism-markup.js"></script>
        <script src="assets/js/prism-css.js"></script>
        <script src="assets/js/prism-javascript.js"></script>

        <script src="assets/js/prism-diff.js"></script>
        <script src="assets/js/prism-csdiff.js"></script>
        <script src="assets/js/prism-function.js"></script>

        <script src="assets/js/jquery-3.1.1.js"></script>


        <script>
            (function (i, s, o, g, r, a, m) {
                i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                    (i[r].q = i[r].q || []).push(arguments)
                }, i[r].l = 1 * new Date(); a = s.createElement(o),
                    m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
            })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

            ga('create', 'UA-4806432-3', 'auto');
            ga('send', 'pageview');

        </script>
        <script src="assets/js/tree.js"></script>
        <script language="javascript">
            buildTree('menuTree', 'using-wpf-menu.html', 'previousButton', 'nextButton');
        </script>
</body>

</html>