<!DOCTYPE html>
<html lang="en" class="js flexbox flexboxlegacy canvas canvastext webgl no-touch geolocation postmessage websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers applicationcache svg inlinesvg smil svgclippaths">

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8" />
    <meta name="keywords" content="">

    <title>Using Information from the parent class in the Inner class</title>
    <link rel="shortcut icon" href="favicon.png" type="image/x-icon" />
    <link rel="stylesheet" href="assets/css/toc.css" />
    <link rel="stylesheet" href="assets/css/highlight.css" />
    <link rel="stylesheet" href="assets/css/prism.css" />
    <link rel="stylesheet" href="assets/css/prism-csdiff.css" />


    <link rel="stylesheet" href="assets/css/theme_firefly.css" />
    <link rel="stylesheet" href="assets/css/mermaid.css" />
</head>

<body class="markdown-body" role="document">
    <div class="wrapper" id="root">
        <div class="backdrop"></div>
        <div class="top-bar" role="navigation" aria-label="footer navigation">
            <div style="display:flex;">
                <div>
                    <a id="menu" class="btn btn-neutral">&#9776; </a>
                </div>
                <img src="assets/img/logo-big.png">
            </div>
            <div>
                <a id="previousButton" class="btn btn-neutral" style="visibility:hidden">Previous</a>
                <a id="nextButton" class="btn btn-neutral" style="visibility:hidden">Next</a>
            </div>
        </div>
        <div class="middle">

            <div class="container">

                <div class="content"><h1 id="using-information-from-the-parent-class-in-the-inner-class">Using Information from the parent class in the Inner class</h1>
<ul>
<li>Let's use the Order_Details table in our inner controller</li>
</ul>
<pre data-line="25,30" class="language-csdiff line-numbers"><code>public class ShowOrdersToDemoInnerClasses : UIControllerBase
{
    public readonly Models.Orders Orders = new Models.Orders();
    public readonly NumberColumn Items = new NumberColumn("Items", "2");
    public readonly NumberColumn TotalQuantity = new NumberColumn("Total Quantity", "4");
    public readonly NumberColumn TotalAmount = new NumberColumn("Total Amount", "5C");
    public ShowOrdersToDemoInnerClasses()
    {
        From = Orders;
    }
    public void Run()
    {
        Execute();
    }
    protected override void OnLoad()
    {
        View = () =&gt; new Views.ShowOrdersToDemoInnerClassesView(this);
    }
    protected override void OnEnterRow()
    {
        new GetTotals(this).Run();
    }
    class GetTotals : BusinessProcessBase
    {
        readonly Models.Order_Details Order_Details = new Models.Order_Details();
        ShowOrdersToDemoInnerClasses _parent;
        public GetTotals(ShowOrdersToDemoInnerClasses parent)
        {
            _parent = parent;
            From = Order_Details;
        }
        public void Run()
        {
            Execute();
        }
    }
} </code></pre>
<ul>
<li>To Filter the <code>GetTotals</code> inner controller based on the current order in the parent controller we'll add the following line:</li>
</ul>
<pre data-line="31" class="language-csdiff line-numbers"><code>public class ShowOrdersToDemoInnerClasses : UIControllerBase
{
    public readonly Models.Orders Orders = new Models.Orders();
    public readonly NumberColumn Items = new NumberColumn("Items", "2");
    public readonly NumberColumn TotalQuantity = new NumberColumn("Total Quantity", "4");
    public readonly NumberColumn TotalAmount = new NumberColumn("Total Amount", "5C");
    public ShowOrdersToDemoInnerClasses()
    {
        From = Orders;
    }
    public void Run()
    {
        Execute();
    }
    protected override void OnLoad()
    {
        View = () =&gt; new Views.ShowOrdersToDemoInnerClassesView(this);
    }
    protected override void OnEnterRow()
    {
        new GetTotals(this).Run();
    }
    class GetTotals : BusinessProcessBase
    {
        readonly Models.Order_Details Order_Details = new Models.Order_Details();
        ShowOrdersToDemoInnerClasses _parent;
        public GetTotals(ShowOrdersToDemoInnerClasses parent)
        {
            _parent = parent;
            From = Order_Details;
            Where.Add(Order_Details.OrderID.IsEqualTo(_parent.Orders.OrderID));
        }
        public void Run()
        {
            Execute();
        }
    }
} </code></pre>
<ul>
<li>We use the <code>_parent</code> field, to access the parent controller, and get the current value of the OrderID column in the Orders Entity.</li>
<li>An inner class can access any of it's parent class fields, including <code>private</code> members - that is what makes it the perfect match for a migrated inner task.</li>
<li>Now let's update the parent's local columns with the information we gather for each row.</li>
</ul>
<pre data-line="35,36,37,40,41,42,43,44,45" class="language-csdiff line-numbers"><code>public class ShowOrdersToDemoInnerClasses : UIControllerBase
{
    public readonly Models.Orders Orders = new Models.Orders();
    public readonly NumberColumn Items = new NumberColumn("Items", "2");
    public readonly NumberColumn TotalQuantity = new NumberColumn("Total Quantity", "4");
    public readonly NumberColumn TotalAmount = new NumberColumn("Total Amount", "5C");
    public ShowOrdersToDemoInnerClasses()
    {
        From = Orders;
    }
    public void Run()
    {
        Execute();
    }
    protected override void OnLoad()
    {
        View = () =&gt; new Views.ShowOrdersToDemoInnerClassesView(this);
    }
    protected override void OnEnterRow()
    {
        new GetTotals(this).Run();
    }
    class GetTotals : BusinessProcessBase
    {
        readonly Models.Order_Details Order_Details = new Models.Order_Details();
        ShowOrdersToDemoInnerClasses _parent;
        public GetTotals(ShowOrdersToDemoInnerClasses parent)
        {
            _parent = parent;
            From = Order_Details;
            Where.Add(Order_Details.OrderID.IsEqualTo(_parent.Orders.OrderID));
        }
        public void Run()
        {
            _parent.Items.Value = 0;
            _parent.TotalQuantity.Value = 0;
            _parent.TotalAmount.Value = 0;
            Execute();
        }
        protected override void OnLeaveRow()
        {
            _parent.Items.Value++;
            _parent.TotalQuantity.Value += Order_Details.Quantity;
            _parent.TotalAmount.Value += Order_Details.Quantity * Order_Details.UnitPrice;
        }
    }
} </code></pre>
<ul>
<li>Note that inner classes are great and easy to use, but they are used a lot less in .NET than they were used in Magic.</li>
<li>Many of the subtasks you've written in magic, will be simple methods in .NET</li>
<li>And in other cases, I would prefer to have a clear and separate controller, that will be easier to reuse than an inner class.</li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/A9gQ-Ob8ZDg?list=PL1DEQjXG2xnK8xPqBW89oPL6AHonic9Iz" frameborder="0" allowfullscreen></iframe>
<ul>
<li><a href="exercise-inner-classes.html">Exercise Inner Classes</a></li>
</ul>



                    <hr />Help us improve,
                    <a href="https://github.com/FireflyMigration/firefly-doc/blob/master//10-Developer-Guide/60-Inner-Classes/20_Using-Information-from-the-parent-class-in-the-Inner-class/index.md" target="_blank">Edit this page on GitHub</a>
                    <br /> or email us at
                    <a href="mailto:info@fireflymigration.com?Subject=Firefly%20Documentation%20Website" target="_top">info@fireflymigration.com</a>
                </div>

                <!-- .content -->




            </div>
            <!-- .container-->

            <aside class="left-sidebar">
                <div class="wy-side-nav-search-ff">
                    <a href="" class="test">
                        
                    </a>
                </div>
                <div id="menuTree" </div>
            </aside>
            <!-- .left-sidebar -->

            <aside class="right-sidebar"></aside>
            <!-- .right-sidebar -->

            </div>
            <!-- .middle-->



        </div>


        <script src="assets/js/mermaid.js"></script>
        <script src="assets/js/prism-start.js"></script>
        <script src="assets/js/prism-clike.js"></script>
        <script src="assets/js/prism-markup.js"></script>
        <script src="assets/js/prism-css.js"></script>
        <script src="assets/js/prism-javascript.js"></script>

        <script src="assets/js/prism-diff.js"></script>
        <script src="assets/js/prism-csdiff.js"></script>
        <script src="assets/js/prism-function.js"></script>

        <script src="assets/js/jquery-3.1.1.js"></script>


        <script>
            (function (i, s, o, g, r, a, m) {
                i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                    (i[r].q = i[r].q || []).push(arguments)
                }, i[r].l = 1 * new Date(); a = s.createElement(o),
                    m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
            })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

            ga('create', 'UA-4806432-3', 'auto');
            ga('send', 'pageview');

        </script>
        <script src="assets/js/tree.js"></script>
        <script language="javascript">
            buildTree('menuTree', 'using-information-from-the-parent-class-in-the-inner-class.html', 'previousButton', 'nextButton');
        </script>
</body>

</html>