<!DOCTYPE html>
<html lang="en" class="js flexbox flexboxlegacy canvas canvastext webgl no-touch geolocation postmessage websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers applicationcache svg inlinesvg smil svgclippaths">

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8" />
    <meta name="keywords" content="">

    <title>Replace Inner Classes With Entity Method</title>
    <link rel="shortcut icon" href="favicon.png" type="image/x-icon" />
    <link rel="stylesheet" href="assets/css/toc.css" />
    <link rel="stylesheet" href="assets/css/highlight.css" />
    <link rel="stylesheet" href="assets/css/prism.css" />
    <link rel="stylesheet" href="assets/css/prism-csdiff.css" />


    <link rel="stylesheet" href="assets/css/theme_firefly.css" />
    <link rel="stylesheet" href="assets/css/mermaid.css" />
</head>

<body class="markdown-body" role="document">
    <div class="wrapper" id="root">
        <div class="backdrop"></div>
        <div class="top-bar" role="navigation" aria-label="footer navigation">
            <div style="display:flex;">
                <div>
                    <a id="menu" class="btn btn-neutral">&#9776; </a>
                </div>
                <img src="assets/img/logo-big.png">
            </div>
            <div>
                <a id="previousButton" class="btn btn-neutral" style="visibility:hidden">Previous</a>
                <a id="nextButton" class="btn btn-neutral" style="visibility:hidden">Next</a>
            </div>
        </div>
        <div class="middle">

            <div class="container">

                <div class="content"><h1 id="replace-inner-classes-with-entity-method">Replace Inner Classes With Entity Method</h1>
<hr />
<iframe width="560" height="315" src="https://www.youtube.com/embed/usn69wc8AhQ?list=PL1DEQjXG2xnIJdh5U16PWRHKJBc5qEmRb" frameborder="0" allowfullscreen></iframe>
<hr />
<p>The Entity class has many useful methods which you can use in new code, or when refactoring existing code. Some of the methods achieve in a few lines of code the same result as what used to be an entire task in Magic.</p>
<h2 id="count-rows">Count Rows</h2>
<p>The CountRows methods returns the number of rows in a table. The method also accepts a filter.</p>
<p><strong>Examples</strong></p>
<p>Return the number of products:</p>
<pre data-line="" class="language-csdiff line-numbers"><code>public long CountProducts()
{
    return new Models.Products().CountRows();
} </code></pre>
<p>Return the number of products in the first category (Beverages):</p>
<pre data-line="" class="language-csdiff line-numbers"><code>public long CountBeveragesProducts()
{
    var products = new Models.Products();
    return products.CountRows(products.CategoryID.IsEqualTo(1));
} </code></pre>
<h2 id="sum">Sum</h2>
<p>The Sum method returns the sum of a specific column of the table. The method also accepts a filter.</p>
<p><strong>Examples</strong></p>
<p>Return the sum of all units in stock:</p>
<pre data-line="" class="language-csdiff line-numbers"><code>public long SumUnitsInStock()
{
    var products = new Models.Products();
    return products.Sum(products.UnitsInStock);
} </code></pre>
<p>Return the Sum units in stock of all beverages:</p>
<pre data-line="" class="language-csdiff line-numbers"><code>public long SumBeveragesUnitsInStock()
{
    var products = new Models.Products();
    return products.Sum(products.UnitsInStock, products.CategoryID.IsEqualTo(1));
} </code></pre>
<h2 id="max">Max</h2>
<p>The Max method returns the maximum value of a specific column of the table. The method also accepts a filter.</p>
<p><strong>Examples</strong></p>
<p>Return the highest unit price of all products:</p>
<pre data-line="" class="language-csdiff line-numbers"><code>public Number GetHighestPrice()
{
    var products = new Models.Products();
    return products.Max(products.UnitPrice);
} </code></pre>
<p>Return the highest unit price of all the beverages products:</p>
<pre data-line="" class="language-csdiff line-numbers"><code>public Number GetHighestBeveragePrice()
{
    var products = new Models.Products();
    return products.Max(products.UnitPrice, products.CategoryID.IsEqualTo(1));
} </code></pre>
<h2 id="min">Min</h2>
<p>The Min method returns the minimum value of a specific column of the table. The method also accepts a filter.</p>
<p><strong>Examples</strong></p>
<p>Return the lowest unit price of all products:</p>
<pre data-line="" class="language-csdiff line-numbers"><code>public Number GetLowestPrice()
{
    var products = new Models.Products();
    return products.Min(products.UnitPrice);
} </code></pre>
<p>Return the lowest unit price which is not zero:</p>
<pre data-line="" class="language-csdiff line-numbers"><code>public Number GetLowestPrice()
{
    var products = new Models.Products();
    return products.Min(products.UnitPrice, products.UnitPrice.IsGreaterThan(0));
} </code></pre>
<h2 id="contains">Contains</h2>
<p>The Contains method return true if the tables contains at least one row that match the filter parameter.</p>
<p><strong>Example</strong></p>
<p>Return true if there is a product in the products table where the units in stock is less or equal the reorder level:</p>
<pre data-line="" class="language-csdiff line-numbers"><code>public bool ShouldReorderStock()
{
    var products = new Models.Products();
    return products.Contains(products.UnitsInStock.IsLessOrEqualTo(products.ReorderLevel));
} </code></pre>
<h2 id="getvalue">GetValue</h2>
<p>The GetValue method gets the value of a specific column of the table, based on a filter expression. It can substitute a Find relation in your programs.
If more than one row match the filter, the first value is returned (same behavior as Find relation). That is why the method also accepts a sort.
One of the most useful usage of this method is when it is added to an ID type in the application, in order to get it's description, wherever the type is used in the application.</p>
<p><strong>Examples</strong></p>
<p>Get the name of the product with id 1:</p>
<pre data-line="" class="language-csdiff line-numbers"><code>public Text GetProductName()
{
    var products = new Models.Products();
    return products.GetValue(products.ProductName, products.ProductID.IsEqualTo(1));
} </code></pre>
<h2 id="insert">Insert</h2>
<p>The Insert method is used to insert a new row to a table. It can substitute an Insert relation or a task with Insert activity.</p>
<p><strong>Example</strong></p>
<p>Insert a new product:</p>
<pre data-line="" class="language-csdiff line-numbers"><code>public void InsertNewProduct()
{
    var products = new Models.Products();
    products.Insert(() =&gt;
    {
        products.ProductID.Value = 99;
        products.ProductName.Value = "New Product";
        products.UnitPrice.Value = 99.99;
    });
} </code></pre>
<h2 id="insertifnotfound">InsertIfNotFound</h2>
<p>The InsertIfNotFound methods works the same as an InsertIfNotFound relation. It inserts a new row to a table only if the row does not exists already.</p>
<p><strong>Example</strong></p>
<p>Insert a new product if such a product does not exists:</p>
<pre data-line="" class="language-csdiff line-numbers"><code>public void InsertNewProductIfNotExits()
{
    var products = new Models.Products();
    products.InsertIfNotFound(products.ProductID.IsEqualTo(99), () =&gt;
    {
        products.ProductID.Value = 99;
        products.ProductName.Value = "New Product";
        products.UnitPrice.Value = 99.99;
    });
} </code></pre>
<h2 id="foreachrow">ForEachRow</h2>
<p>The ForEachRow method iterates on all rows of the table and let you add logic code that will be executed for each row. The method also accepts filter and sort.</p>
<p><strong>Example</strong></p>
<p>Update all prices by 10 percent:</p>
<pre data-line="" class="language-csdiff line-numbers"><code>public void UpdatePricesBy10Percent()
{
    var products = new Models.Products();
    products.ForEachRow(() =&gt;
    {
        products.UnitPrice.Value *= 1.1;
    });
} </code></pre>
<p>Iterate all orders of a customer:</p>
<pre data-line="" class="language-csdiff line-numbers"><code>var o = new Models.Orders();
o.ForEachRow(o.CustomerID.IsEqualTo("ALFKI"), new Sort(o.OrderDate), () =&gt;
{
    // dosomething
}); </code></pre>
<h2 id="update">Update</h2>
<p>The Update method updates any row of the table that match the filter parameter.</p>
<p><strong>Example</strong></p>
<pre data-line="" class="language-csdiff line-numbers"><code>var products = new Models.Products();
products.Update(products.ProductID.IsEqualTo(1),() =&gt;
{
    products.UnitPrice.Value *= 1.1;
}); </code></pre>
<h2 id="drop">Drop</h2>
<p>The Drop method drop the table from the database, similar to the DbDel function.</p>
<p><strong>Example</strong></p>
<pre data-line="" class="language-csdiff line-numbers"><code>public void DropProductsTable()
{
    new Models.Products().Drop();
} </code></pre>
<h2 id="truncate">Truncate</h2>
<p>The Truncate method removes all rows from the table.</p>
<p><strong>Example</strong></p>
<pre data-line="" class="language-csdiff line-numbers"><code>public void ClearProductsTable()
{
    new Models.Products().Truncate();
} </code></pre>
<h2 id="delete">Delete</h2>
<p>The Delete method is used to delete existing rows from the table that match the filter parameter.</p>
<p><strong>Example</strong></p>
<pre data-line="" class="language-csdiff line-numbers"><code>public void DeleteAllBeverages()
{
    var products = new Models.Products();
    products.Delete(products.CategoryID.IsEqualTo(1));
} </code></pre>



                    <hr />Help us improve,
                    <a href="https://github.com/FireflyMigration/firefly-doc/blob/master//30-Maintaining-the-Migrated-Application/10-Common-migrated-code-patterns-and-how-to-improve-on-them-in-new-code-in-NET/02-Replace-Inner-Classes-With-Entity-Method.md" target="_blank">Edit this page on GitHub</a>
                    <br /> or email us at
                    <a href="mailto:info@fireflymigration.com?Subject=Firefly%20Documentation%20Website" target="_top">info@fireflymigration.com</a>
                </div>

                <!-- .content -->




            </div>
            <!-- .container-->

            <aside class="left-sidebar">
                <div class="wy-side-nav-search-ff">
                    <a href="" class="test">
                        
                    </a>
                </div>
                <div id="menuTree" </div>
            </aside>
            <!-- .left-sidebar -->

            <aside class="right-sidebar"></aside>
            <!-- .right-sidebar -->

            </div>
            <!-- .middle-->



        </div>


        <script src="assets/js/mermaid.js"></script>
        <script src="assets/js/prism-start.js"></script>
        <script src="assets/js/prism-clike.js"></script>
        <script src="assets/js/prism-markup.js"></script>
        <script src="assets/js/prism-css.js"></script>
        <script src="assets/js/prism-javascript.js"></script>

        <script src="assets/js/prism-diff.js"></script>
        <script src="assets/js/prism-csdiff.js"></script>
        <script src="assets/js/prism-function.js"></script>

        <script src="assets/js/jquery-3.1.1.js"></script>


        <script>
            (function (i, s, o, g, r, a, m) {
                i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                    (i[r].q = i[r].q || []).push(arguments)
                }, i[r].l = 1 * new Date(); a = s.createElement(o),
                    m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
            })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

            ga('create', 'UA-4806432-3', 'auto');
            ga('send', 'pageview');

        </script>
        <script src="assets/js/tree.js"></script>
        <script language="javascript">
            buildTree('menuTree', 'replace-inner-classes-with-entity-method.html', 'previousButton', 'nextButton');
        </script>
</body>

</html>